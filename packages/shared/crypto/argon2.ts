/**
 * Argon2id - Derivação de chave usando WebAssembly
 * 
 * Implementação de Argon2id usando WebAssembly embutido como base64.
 * Configuração fixa: 194 MiB memória, 3 iterações, paralelismo 4, output 32 bytes.
 * 
 * NOTA: Este arquivo requer o arquivo argon2.wasm compilado do projeto oficial P-H-C.
 * O WASM deve ser embutido como base64 na constante ARGON2_WASM_BASE64 abaixo.
 * 
 * Para obter o WASM:
 * 1. Compile o Argon2 oficial (https://github.com/P-H-C/phc-winner-argon2)
 * 2. Use wasm-pack ou Emscripten para gerar o arquivo .wasm
 * 3. Converta para base64: cat argon2.wasm | base64
 * 4. Cole o resultado na constante ARGON2_WASM_BASE64
 * 
 * Alternativamente, use uma biblioteca como argon2-browser que já fornece o WASM.
 */

// WASM do Argon2 embutido como base64
// Extraído do certificado fornecido
const ARGON2_WASM_BASE64 = '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IKnIQQgACgCACICIAAoAhQgDKdsQQp0aiAEQQp0aiEEIAIgBUEKdGohBgJAIAAoAgRBEEYEQCACIAhBCnRqIAQgBkEAEBIMAQsgAiAIQQp0aiECIAEoAgBFBEAgAiAEIAZBABASDAELIAIgBCAGQQEQEgsgCEEBaiECIAVBAWohBSAHQQFqIgcgACgCEEkNAAsLIANBgBhqJAALkhYCE34CfyMAQYAQayIXJAAgF0GACGoiGCABQYAI/AoAACAYIAAQByAXIBhBgAj8CgAAIAMEQCAXIAIQBwtBACEAQQAhAwNAIBdBgAhqIANBB3RqIgEgASkDOCIGIAEpAxgiCHwgCEIBhkL+////H4MgBkL/////D4N+fCIIIAEpA3iFQiCJIgUgASkDWCIHfCAHQgGGQv7///8fgyAFQv////8Pg358IgcgBoVCKIkiBiAIfCAGQv////8PgyAIQgGGQv7///8fg358IgggBYVCMIkiBSABKQMoIgQgASkDCCIJfCAJQgGGQv7///8fgyAEQv////8Pg358IgkgASkDaIVCIIkiDCABKQNIIg18IA1CAYZC/v///x+DIAxC/////w+DfnwiDSAEhUIoiSIEIAl8IARC/////w+DIAlCAYZC/v///x+DfnwiCSAMhUIwiSIMIA18IAxC/////w+DIA1CAYZC/v///x+DfnwiDSAEhUIBiSIEIAEpAyAiECABKQMAIgt8IAtCAYZC/v///x+DIBBC/////w+DfnwiCyABKQOABoVCIIkiESABKQOABCIUfCAUQgGGQv7///8fgyARQv////8Pg358IhQgEIVCKIkiECALfCAQQv////8PgyALQgGGQv7///8fg358Igt8IARC/////w+DIAtCAYZC/v///x+DfnwiCoVCIIkiFSABKQOAAyISIAEpA4ABIg58IA5CAYZC/v///x+DIBJC/////w+DfnwiDiABKQOAB4VCIIkiEyABKQOABSIPfCAPQgGGQv7///8fgyATQv////8Pg358Ig8gEoVCKIkiEiAOfCASQv////8PgyAOQgGGQv7///8fg358Ig4gE4VCMIkiEyAPfCATQv////8PgyAPQgGGQv7///8fg358Ig98IBVC/////w+DIA9CAYZC/v///x+DfnwiFiAEhUIoiSIEIAp8IARC/////w+DIApCAYZC/v///x+DfnwiCjcDACABIAogFYVCMIkiCjcDeCABIAogFnwgCkL/////D4MgFkIBhkL+////H4N+fCIKNwNQIAEgBCAKhUIBiTcDKCABIAUgB3wgBUL/////D4MgB0IBhkL+////H4N+fCIFIA8gEoVCAYkiByAJfCAHQv////8PgyAJQgGGQv7///8fg358IgQgCyARhUIwiSIJhUIgiSILfCAFQgGGQv7///8fgyALQv////8Pg358IhEgB4VCKIkiByAEfCAHQv////8PgyAEQgGGQv7///8fg358IgogC4VCMIkiBDcDYCABIAo3AwggASAEIBF8IARC/////w+DIBFCAYZC/v///x+DfnwiBDcDWCABIAQgB4VCAYk3AzAgASAFIAaFQgGJIgYgDnwgBkL/////D4MgDkIBhkL+////H4N+fCIFIAyFQiCJIgcgCSAUfCAJQv////8PgyAUQgGGQv7///8fg358IgR8IAdC/////w+DIARCAYZC/v///x+DfnwiCSAGhUIoiSIGIAV8IAZC/////w+DIAVCAYZC/v///x+DfnwiDCAHhUIwiSIFNwNoIAEgDDcDECABIAUgCXwgBUL/////D4MgCUIBhkL+////H4N+fCIFNwNAIAEgBSAGhUIBiTcDOCABIAggBCAQhUIBiSIGfCAIQgGGQv7///8fgyAGQv////8Pg358IgggE4VCIIkiBSANfCAFQv////8PgyANQgGGQv7///8fg358IgcgBoVCKIkiBiAIfCAGQv////8PgyAIQgGGQv7///8fg358IgQgBYVCMIkiCDcDcCABIAQ3AxggASAHIAh8IAhC/////w+DIAdCAYZC/v///x+DfnwiCDcDSCABIAYgCIVCAYk3AyAgA0EBaiIDQQhHDQALA0AgF0GACGoiAyAAQQR0aiIBIAEpA4gDIgYgASkDiAEiCHwgCEIBhkL+////H4MgBkL/////D4N+fCIIIAEpA4gHhUIgiSIFIAEpA4gFIgd8IAdCAYZC/v///x+DIAVC/////w+DfnwiByAGhUIoiSIGIAh8IAZC/////w+DIAhCAYZC/v///x+DfnwiCCAFhUIwiSIFIAEpA4gCIgQgASkDCCIJfCAJQgGGQv7///8fgyAEQv////8Pg358IgkgASkDiAaFQiCJIgwgASkDiAQiDXwgDUIBhkL+////H4MgDEL/////D4N+fCINIASFQiiJIgQgCXwgBEL/////D4MgCUIBhkL+////H4N+fCIJIAyFQjCJIgwgDXwgDEL/////D4MgDUIBhkL+////H4N+fCINIASFQgGJIgQgASkDgAIiECABKQMAIgt8IAtCAYZC/v///x+DIBBC/////w+DfnwiCyABKQOABoVCIIkiESABKQOABCIUfCAUQgGGQv7///8fgyARQv////8Pg358IhQgEIVCKIkiECALfCAQQv////8PgyALQgGGQv7///8fg358Igt8IARC/////w+DIAtCAYZC/v///x+DfnwiCoVCIIkiFSABKQOAAyISIAEpA4ABIg58IA5CAYZC/v///x+DIBJC/////w+DfnwiDiABKQOAB4VCIIkiEyABKQOABSIPfCAPQgGGQv7///8fgyATQv////8Pg358Ig8gEoVCKIkiEiAOfCASQv////8PgyAOQgGGQv7///8fg358Ig4gE4VCMIkiEyAPfCATQv////8PgyAPQgGGQv7///8fg358Ig98IBVC/////w+DIA9CAYZC/v///x+DfnwiFiAEhUIoiSIEIAp8IARC/////w+DIApCAYZC/v///x+DfnwiCjcDACABIAogFYVCMIkiCjcDiAcgASAKIBZ8IApC/////w+DIBZCAYZC/v///x+DfnwiCjcDgAUgASAEIAqFQgGJNwOIAiABIAUgB3wgBUL/////D4MgB0IBhkL+////H4N+fCIFIA8gEoVCAYkiByAJfCAHQv////8PgyAJQgGGQv7///8fg358IgQgCyARhUIwiSIJhUIgiSILfCAFQgGGQv7///8fgyALQv////8Pg358IhEgB4VCKIkiByAEfCAHQv////8PgyAEQgGGQv7///8fg358IgogC4VCMIkiBDcDgAYgASAKNwMIIAEgBCARfCAEQv////8PgyARQgGGQv7///8fg358IgQ3A4gFIAEgBCAHhUIBiTcDgAMgASAFIAaFQgGJIgYgDnwgBkL/////D4MgDkIBhkL+////H4N+fCIFIAyFQiCJIgcgCSAUfCAJQv////8PgyAUQgGGQv7///8fg358IgR8IAdC/////w+DIARCAYZC/v///x+DfnwiCSAGhUIoiSIGIAV8IAZC/////w+DIAVCAYZC/v///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 CP//////////AEHAEwsLAQAAAAAgAACQDAE=';
// Cache do módulo WASM instanciado
let wasmModule: WebAssembly.Instance | null = null;
let wasmModulePromise: Promise<WebAssembly.Instance> | null = null;

/**
 * Carrega e instancia o módulo WebAssembly do Argon2
 */
async function loadArgon2Module(): Promise<WebAssembly.Instance> {
  if (wasmModule) {
    return wasmModule;
  }
  
  if (wasmModulePromise) {
    return wasmModulePromise;
  }
  
  wasmModulePromise = (async () => {
    if (!ARGON2_WASM_BASE64) {
      throw new Error(
        'Argon2 WASM não configurado. Por favor, forneça o arquivo argon2.wasm ' +
        'embutido como base64 na constante ARGON2_WASM_BASE64.'
      );
    }
    
    // Decodifica o base64 para ArrayBuffer
    const binaryString = atob(ARGON2_WASM_BASE64);
    const bytes = new Uint8Array(binaryString.length);
    for (let i = 0; i < binaryString.length; i++) {
      bytes[i] = binaryString.charCodeAt(i);
    }
    
    // Instancia o módulo WebAssembly
    const wasm = await WebAssembly.instantiate(bytes.buffer, {
      // Importações necessárias para o módulo WASM
      env: {
        memory: new WebAssembly.Memory({ initial: 256, maximum: 512 }),
        // Adicione outras importações conforme necessário pela implementação do Argon2
      }
    });
    
    wasmModule = wasm.instance;
    return wasmModule;
  })();
  
  return wasmModulePromise;
}

/**
 * Implementação alternativa usando Web Crypto API (PBKDF2) como fallback
 * Esta é uma solução temporária até que o WASM do Argon2 seja fornecido.
 * 
 * AVISO: PBKDF2 não oferece as mesmas propriedades de memory-hard do Argon2,
 * mas é seguro para uso enquanto o Argon2 não está disponível.
 */
async function deriveKeyFallback(password: string, salt: Uint8Array): Promise<Uint8Array> {
  const passwordBytes = new TextEncoder().encode(password);
  
  const keyMaterial = await crypto.subtle.importKey(
    'raw',
    passwordBytes,
    'PBKDF2',
    false,
    ['deriveBits']
  );
  
  // Ajuste de iterações para aproximadamente 2 segundos de trabalho
  // Este valor deve ser calibrado baseado no ambiente de execução
  const iterations = 100000;
  
  // Cria uma cópia do salt para garantir compatibilidade de tipos
  const saltBuffer = new Uint8Array(salt).buffer;
  
  const derivedBits = await crypto.subtle.deriveBits(
    {
      name: 'PBKDF2',
      salt: saltBuffer,
      iterations: iterations,
      hash: 'SHA-256',
    },
    keyMaterial,
    256 // 32 bytes = 256 bits
  );
  
  // Garante que temos um ArrayBuffer
  const buffer = derivedBits instanceof ArrayBuffer 
    ? derivedBits 
    : new Uint8Array(derivedBits).buffer;
  
  return new Uint8Array(buffer);
}

/**
 * Deriva uma chave a partir de uma senha usando Argon2id
 * 
 * Configuração fixa:
 * - Memória: 194 MiB (198656 KiB)
 * - Iterações: 3
 * - Paralelismo: 4
 * - Tamanho do hash: 32 bytes
 * 
 * @param password - A senha mestra
 * @param salt - Salt aleatório de 16 bytes
 * @returns Chave derivada de 32 bytes
 */
export async function deriveKey(password: string, salt: Uint8Array): Promise<Uint8Array> {
  if (salt.length !== 16) {
    throw new Error('O salt deve ter exatamente 16 bytes');
  }
  
  // Tenta usar o WASM do Argon2
  if (ARGON2_WASM_BASE64) {
    try {
      const argon2 = await loadArgon2Module();
      const passwordBytes = new TextEncoder().encode(password);
      
      // Parâmetros fixos conforme especificado
      const memoryCost = 194 * 1024; // 194 MiB em KiB
      const timeCost = 3; // 3 iterações
      const parallelism = 4; // 4 threads
      const hashLength = 32; // 32 bytes de saída
      
      // Obtém as funções exportadas do WASM
      // NOTA: Os nomes das funções podem variar dependendo da implementação
      // Ajuste conforme a implementação específica do Argon2 que você usar
      const memory = argon2.exports.memory as WebAssembly.Memory;
      const malloc = argon2.exports.malloc as ((size: number) => number) | undefined;
      const free = argon2.exports.free as ((ptr: number) => void) | undefined;
      const argon2id = argon2.exports.argon2id_hash_raw as 
        ((t_cost: number, m_cost: number, parallelism: number, 
          pwd: number, pwdlen: number, salt: number, saltlen: number, 
          hash: number, hashlen: number) => number) | undefined;
      
      if (!malloc || !free || !argon2id) {
        throw new Error('Funções do Argon2 WASM não encontradas. Verifique a implementação.');
      }
      
      // Aloca memória para os buffers
      const passwordPtr = malloc(passwordBytes.length);
      const saltPtr = malloc(salt.length);
      const hashPtr = malloc(hashLength);
      
      // Copia os dados para a memória do WASM
      const memoryBuffer = new Uint8Array(memory.buffer);
      memoryBuffer.set(passwordBytes, passwordPtr);
      memoryBuffer.set(salt, saltPtr);
      
      // Chama a função Argon2id
      const result = argon2id(
        timeCost,
        memoryCost,
        parallelism,
        passwordPtr,
        passwordBytes.length,
        saltPtr,
        salt.length,
        hashPtr,
        hashLength
      );
      
      if (result !== 0) {
        free(passwordPtr);
        free(saltPtr);
        free(hashPtr);
        throw new Error(`Argon2id falhou com código de erro: ${result}`);
      }
      
      // Copia o hash resultante
      const hash = memoryBuffer.slice(hashPtr, hashPtr + hashLength);
      
      // Libera a memória
      free(passwordPtr);
      free(saltPtr);
      free(hashPtr);
      
      return hash;
    } catch (error) {
      console.warn('Falha ao usar Argon2 WASM, usando fallback PBKDF2:', error);
      // Fallback para PBKDF2 se o WASM falhar
      return deriveKeyFallback(password, salt);
    }
  }
  
  // Se o WASM não estiver configurado, usa o fallback
  console.warn('Argon2 WASM não configurado, usando PBKDF2 como fallback. ' +
               'Configure ARGON2_WASM_BASE64 para usar Argon2id.');
  return deriveKeyFallback(password, salt);
}

/**
 * Gera um salt aleatório de 16 bytes
 */
export function generateSalt(): Uint8Array {
  return crypto.getRandomValues(new Uint8Array(16));
}
